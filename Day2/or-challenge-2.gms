$title Finding shortest path with an additional budget constraint
$onText
    Solution for OR-Challenge 2nd Dec 2024 Â© 2024 by Sascha Herrmann is licensed under CC BY 4.0
    https://www.linkedin.com/in/sascha-herrmann-659876100/
    
$offText    

set v 'nodes in the network' / 1*100/;
alias (v,vv);

* we model the problem as a network flow problem with source node 1 and sink node 100
parameter b(v) 'demand of the network' /
1 1
100 -1
/;

parameter dist(v,vv) 'distance between two nodes' /
1   .   37  60
1   .   59  9
1   .   72  63
2   .   15  61
2   .   20  16
2   .   26  54
2   .   37  26
2   .   58  54
2   .   60  25
2   .   76  72
2   .   80  35
2   .   90  73
2   .   95  23
2   .   100 20
3   .   15  30
3   .   37  51
3   .   40  75
3   .   41  19
3   .   56  27
3   .   59  17
3   .   73  84
3   .   76  78
4   .   7   58
4   .   29  42
4   .   46  38
4   .   61  33
4   .   80  61
4   .   83  49
4   .   98  20
5   .   11  37
5   .   34  28
5   .   55  84
5   .   79  76
5   .   80  62
5   .   85  10
5   .   87  43
5   .   92  57
5   .   99  28
6   .   8   22
6   .   15  63
6   .   24  16
6   .   30  68
6   .   31  13
6   .   35  24
6   .   39  58
6   .   40  77
6   .   41  17
6   .   51  75
6   .   74  52
6   .   82  87
7   .   6   37
7   .   8   23
7   .   10  97
7   .   24  53
7   .   25  59
7   .   35  13
7   .   47  75
7   .   52  6
7   .   74  54
8   .   6   22
8   .   16  92
8   .   18  59
8   .   21  62
8   .   25  74
8   .   26  87
8   .   39  78
8   .   46  49
8   .   55  40
8   .   58  42
8   .   63  21
8   .   83  49
9   .   5   28
9   .   18  31
9   .   22  61
9   .   48  66
9   .   60  45
9   .   79  66
9   .   92  42
10  .   13  49
10  .   15  94
10  .   31  75
10  .   37  89
10  .   85  49
10  .   88  57
10  .   93  49
10  .   96  77
11  .   1   67
11  .   2   44
11  .   13  30
11  .   15  75
11  .   22  10
11  .   24  60
11  .   34  61
11  .   48  24
11  .   53  7
11  .   54  18
11  .   55  66
11  .   61  66
11  .   62  7
11  .   82  45
11  .   89  77
11  .   92  64
12  .   16  85
12  .   27  47
12  .   32  30
12  .   65  47
12  .   77  79
13  .   11  30
13  .   50  47
13  .   59  50
13  .   74  7
13  .   100 23
14  .   18  30
14  .   32  50
14  .   39  62
14  .   47  23
14  .   63  76
14  .   79  82
14  .   85  13
14  .   100 45
15  .   14  41
15  .   25  44
15  .   27  56
15  .   37  81
15  .   44  35
15  .   48  78
15  .   60  43
15  .   63  42
16  .   4   62
16  .   41  69
16  .   53  13
16  .   60  78
16  .   81  12
16  .   84  21
16  .   90  24
16  .   97  9
17  .   7   69
17  .   12  47
17  .   28  35
17  .   35  68
17  .   37  85
17  .   42  69
17  .   46  53
17  .   47  40
17  .   64  41
17  .   66  39
17  .   81  41
17  .   88  43
17  .   91  24
17  .   93  16
17  .   100 42
18  .   30  19
18  .   31  45
18  .   49  45
18  .   53  34
18  .   59  49
18  .   64  34
18  .   66  32
18  .   67  34
19  .   6   91
19  .   12  46
19  .   30  24
19  .   39  68
19  .   40  47
19  .   42  85
19  .   47  19
19  .   53  64
19  .   72  90
19  .   81  64
20  .   8   48
20  .   16  44
20  .   29  7
20  .   38  31
20  .   42  31
20  .   47  77
20  .   66  49
20  .   83  62
20  .   95  11
21  .   16  63
21  .   28  12
21  .   31  58
21  .   40  48
21  .   44  15
21  .   57  19
21  .   79  66
22  .   9   61
22  .   10  17
22  .   11  10
22  .   12  71
22  .   16  16
22  .   33  30
22  .   47  71
22  .   64  65
22  .   66  62
22  .   77  69
22  .   82  40
22  .   91  51
22  .   94  84
23  .   4   23
23  .   20  43
23  .   58  26
23  .   64  8
23  .   66  6
23  .   67  17
23  .   68  46
23  .   86  51
23  .   89  25
23  .   98  41
24  .   1   58
24  .   12  78
24  .   27  100
24  .   29  40
24  .   57  61
24  .   69  62
24  .   86  71
25  .   34  24
25  .   44  26
25  .   61  36
25  .   81  49
25  .   86  33
26  .   39  10
26  .   41  65
26  .   43  80
26  .   44  57
26  .   57  44
26  .   78  9
26  .   80  84
26  .   94  95
27  .   9   39
27  .   19  1
27  .   21  33
27  .   36  26
27  .   45  83
27  .   53  64
27  .   60  78
27  .   89  45
28  .   5   26
28  .   44  25
28  .   48  68
28  .   52  51
28  .   64  8
28  .   68  51
28  .   81  66
28  .   82  40
28  .   96  10
28  .   98  37
29  .   20  7
29  .   68  22
29  .   81  36
29  .   83  55
29  .   87  12
29  .   99  23
29  .   100 6
30  .   4   11
30  .   29  38
30  .   33  23
30  .   55  85
30  .   90  44
30  .   99  29
31  .   3   40
31  .   6   13
31  .   11  49
31  .   19  88
31  .   25  65
31  .   42  18
31  .   64  64
31  .   71  32
31  .   89  80
31  .   94  67
32  .   2   32
32  .   6   33
32  .   15  30
32  .   19  66
32  .   27  66
32  .   41  17
32  .   56  32
32  .   72  52
32  .   84  82
32  .   85  56
32  .   92  11
33  .   5   22
33  .   8   59
33  .   20  20
33  .   39  32
33  .   46  45
33  .   61  42
33  .   69  28
33  .   76  39
33  .   84  45
33  .   86  24
34  .   24  80
34  .   26  77
34  .   38  37
34  .   41  50
34  .   42  59
34  .   57  33
34  .   58  31
34  .   59  34
34  .   81  68
34  .   89  17
34  .   90  73
34  .   92  47
34  .   96  10
34  .   100 41
35  .   33  47
35  .   34  50
35  .   43  11
35  .   48  55
35  .   49  20
35  .   52  14
35  .   62  68
35  .   65  76
35  .   88  35
36  .   6   64
36  .   33  24
36  .   40  43
36  .   45  57
36  .   53  51
36  .   56  71
36  .   62  50
36  .   69  22
36  .   76  39
36  .   99  34
36  .   100 34
37  .   12  81
37  .   19  105
37  .   24  4
37  .   41  35
37  .   56  58
37  .   69  65
37  .   76  95
38  .   6   30
38  .   20  31
38  .   26  70
38  .   32  4
38  .   35  15
38  .   51  46
38  .   81  61
38  .   82  66
38  .   86  58
38  .   90  80
38  .   95  26
39  .   12  76
39  .   20  30
39  .   43  70
39  .   50  63
39  .   77  55
39  .   88  34
39  .   99  19
40  .   11  21
40  .   12  71
40  .   27  46
40  .   47  65
40  .   55  87
40  .   68  25
40  .   74  30
40  .   78  27
40  .   82  31
40  .   88  47
40  .   100 50
41  .   2   16
41  .   7   25
41  .   23  39
41  .   27  75
41  .   45  14
41  .   49  12
41  .   58  39
41  .   73  76
41  .   77  33
41  .   79  24
41  .   83  46
41  .   87  29
41  .   97  61
41  .   99  45
42  .   7   28
42  .   14  69
42  .   30  63
42  .   31  18
42  .   51  67
42  .   61  49
42  .   68  51
42  .   70  28
42  .   93  82
42  .   94  52
42  .   100 27
43  .   6   33
43  .   8   24
43  .   31  41
43  .   33  44
43  .   45  15
43  .   61  27
43  .   69  25
43  .   75  25
43  .   77  51
43  .   85  63
44  .   7   36
44  .   56  54
44  .   58  35
44  .   67  30
44  .   76  51
44  .   79  51
44  .   84  61
44  .   94  38
44  .   98  40
45  .   6   20
45  .   7   17
45  .   14  67
45  .   43  15
45  .   44  37
45  .   46  40
45  .   53  69
45  .   65  78
45  .   92  7
45  .   99  58
46  .   4   38
46  .   18  42
46  .   25  41
46  .   44  29
46  .   51  30
46  .   72  73
46  .   80  33
46  .   82  61
47  .   5   37
47  .   13  49
47  .   15  48
47  .   20  77
47  .   39  84
47  .   55  116
47  .   72  100
47  .   75  94
47  .   84  75
47  .   87  79
48  .   2   27
48  .   7   65
48  .   11  24
48  .   25  57
48  .   55  43
48  .   60  51
48  .   66  66
48  .   73  49
48  .   86  37
48  .   100 31
49  .   7   33
49  .   20  28
49  .   26  66
49  .   31  13
49  .   57  48
49  .   66  56
50  .   7   20
50  .   9   48
50  .   10  86
50  .   14  64
50  .   34  53
50  .   42  8
50  .   66  47
50  .   78  65
50  .   81  65
50  .   87  38
50  .   95  33
51  .   7   54
51  .   14  12
51  .   38  46
51  .   39  71
51  .   47  22
51  .   50  62
51  .   68  54
51  .   85  26
51  .   86  53
51  .   89  21
51  .   98  33
52  .   2   43
52  .   3   15
52  .   26  91
52  .   36  58
52  .   37  54
52  .   41  28
52  .   53  81
52  .   65  80
52  .   76  93
52  .   96  60
52  .   99  68
53  .   2   45
53  .   4   54
53  .   16  13
53  .   19  64
53  .   23  61
53  .   35  69
53  .   37  64
53  .   39  4
53  .   49  58
53  .   56  93
53  .   74  29
53  .   75  68
53  .   80  74
53  .   92  68
53  .   94  85
53  .   97  7
53  .   100 40
54  .   18  43
54  .   22  23
54  .   24  57
54  .   34  77
54  .   39  7
54  .   40  33
54  .   75  70
54  .   84  35
54  .   93  66
54  .   97  15
54  .   98  57
54  .   100 46
55  .   7   58
55  .   12  84
55  .   25  86
55  .   28  87
55  .   41  38
55  .   44  63
55  .   57  68
55  .   70  19
55  .   78  64
55  .   83  82
55  .   89  98
56  .   14  78
56  .   23  54
56  .   26  102
56  .   28  62
56  .   35  24
56  .   46  42
56  .   58  32
56  .   84  113
56  .   88  59
57  .   5   16
57  .   21  19
57  .   25  18
57  .   26  44
57  .   35  49
57  .   42  48
57  .   46  42
57  .   48  39
57  .   50  47
57  .   58  50
57  .   72  50
57  .   75  55
58  .   2   54
58  .   5   53
58  .   10  97
58  .   19  66
58  .   21  37
58  .   64  24
58  .   75  45
58  .   77  71
58  .   96  39
59  .   2   51
59  .   8   38
59  .   24  66
59  .   36  47
59  .   44  36
59  .   49  46
59  .   63  25
59  .   78  83
59  .   89  34
60  .   2   25
60  .   6   21
60  .   30  59
60  .   39  65
60  .   40  77
60  .   82  78
60  .   89  58
60  .   94  40
61  .   11  66
61  .   39  74
61  .   48  69
61  .   63  43
61  .   71  45
61  .   72  72
61  .   82  57
61  .   95  41
61  .   100 38
62  .   9   64
62  .   10  27
62  .   19  64
62  .   20  29
62  .   23  60
62  .   27  64
62  .   39  4
62  .   60  64
62  .   77  56
62  .   79  70
62  .   85  49
62  .   98  46
62  .   100 39
63  .   5   76
63  .   12  48
63  .   34  59
63  .   38  32
63  .   40  100
63  .   44  52
63  .   47  89
63  .   52  10
63  .   54  95
63  .   62  89
63  .   68  78
63  .   96  68
64  .   4   25
64  .   8   59
64  .   17  41
64  .   30  33
64  .   36  22
64  .   51  17
64  .   68  53
65  .   11  47
65  .   15  57
65  .   22  43
65  .   30  15
65  .   47  29
65  .   57  31
65  .   70  83
66  .   6   61
66  .   19  40
66  .   20  49
66  .   21  14
66  .   37  78
66  .   38  32
66  .   41  44
66  .   49  56
66  .   52  44
66  .   60  44
66  .   76  59
66  .   92  41
67  .   6   72
67  .   41  55
67  .   52  58
67  .   68  52
67  .   86  52
68  .   8   68
68  .   17  31
68  .   35  57
68  .   39  17
68  .   41  44
68  .   55  62
68  .   66  51
68  .   70  44
68  .   72  38
68  .   92  55
69  .   8   48
69  .   51  27
69  .   72  59
70  .   5   68
70  .   9   71
70  .   13  54
70  .   18  49
70  .   20  26
70  .   22  58
70  .   24  13
70  .   25  70
70  .   27  92
70  .   28  75
70  .   35  43
70  .   42  28
70  .   56  64
70  .   78  46
70  .   93  87
71  .   2   25
71  .   9   41
71  .   20  10
71  .   74  14
71  .   77  45
71  .   85  41
71  .   89  60
71  .   99  17
72  .   5   65
72  .   8   52
72  .   17  67
72  .   27  89
72  .   35  49
72  .   37  26
72  .   44  50
72  .   53  39
72  .   55  27
72  .   83  80
72  .   86  53
73  .   28  68
73  .   85  42
73  .   97  20
73  .   99  31
74  .   7   54
74  .   8   63
74  .   11  23
74  .   34  38
74  .   38  37
74  .   51  39
74  .   55  66
74  .   79  62
75  .   8   11
75  .   16  81
75  .   23  53
75  .   33  51
75  .   40  83
75  .   45  10
75  .   70  33
75  .   71  43
75  .   72  41
75  .   96  73
76  .   4   38
76  .   21  46
76  .   25  33
76  .   30  29
76  .   39  42
76  .   41  74
76  .   43  81
76  .   61  69
76  .   68  36
76  .   74  35
76  .   84  20
76  .   97  32
77  .   30  77
77  .   63  60
77  .   70  11
77  .   76  89
77  .   78  56
77  .   79  26
77  .   88  37
77  .   91  78
78  .   11  10
78  .   36  54
78  .   48  21
78  .   49  58
78  .   65  57
78  .   68  17
78  .   84  30
78  .   88  35
78  .   95  36
79  .   1   43
79  .   22  80
79  .   41  24
79  .   46  58
79  .   51  80
79  .   54  73
79  .   57  62
79  .   68  63
79  .   71  49
79  .   88  41
80  .   1   17
80  .   25  62
80  .   37  47
80  .   40  84
80  .   41  20
80  .   44  37
80  .   47  81
80  .   61  36
80  .   93  82
80  .   97  80
80  .   100 35
81  .   7   78
81  .   29  36
81  .   43  72
81  .   65  53
81  .   85  49
81  .   94  86
82  .   20  59
82  .   68  43
82  .   70  85
82  .   73  38
82  .   74  35
82  .   92  77
82  .   93  5
82  .   100 55
83  .   3   27
83  .   4   49
83  .   11  80
83  .   18  52
83  .   19  64
83  .   32  28
83  .   45  42
83  .   48  80
83  .   50  43
83  .   63  35
83  .   65  65
83  .   78  88
83  .   91  41
83  .   99  69
84  .   4   55
84  .   10  5
84  .   12  82
84  .   17  37
84  .   31  76
84  .   52  101
84  .   86  20
84  .   90  3
84  .   99  33
85  .   2   65
85  .   3   60
85  .   5   10
85  .   13  23
85  .   14  13
85  .   61  45
85  .   69  38
85  .   73  42
85  .   76  26
85  .   87  52
85  .   92  66
85  .   94  59
85  .   95  42
85  .   98  8
86  .   6   68
86  .   7   75
86  .   19  46
86  .   23  51
86  .   38  58
86  .   68  16
86  .   74  21
86  .   79  79
86  .   90  22
86  .   91  43
86  .   92  68
87  .   20  5
87  .   25  46
88  .   22  40
88  .   27  63
88  .   30  40
88  .   39  34
88  .   49  27
88  .   63  57
88  .   70  29
88  .   75  36
88  .   76  55
88  .   79  41
88  .   83  56
88  .   95  7
88  .   96  56
88  .   97  40
88  .   100 8
89  .   12  14
89  .   16  94
89  .   35  57
89  .   52  53
89  .   57  50
89  .   68  69
89  .   70  88
89  .   91  29
90  .   5   45
90  .   8   104
90  .   12  83
90  .   14  57
90  .   15  92
90  .   30  44
90  .   45  93
90  .   46  87
90  .   65  44
90  .   72  70
90  .   75  95
90  .   94  97
91  .   3   43
91  .   4   8
91  .   14  10
91  .   36  6
91  .   47  30
91  .   55  85
91  .   77  78
91  .   83  41
91  .   88  42
91  .   96  15
92  .   4   57
92  .   6   25
92  .   9   42
92  .   32  11
92  .   42  16
92  .   93  77
92  .   97  73
93  .   2   75
93  .   29  56
93  .   38  65
93  .   43  73
93  .   48  69
93  .   59  72
93  .   73  42
93  .   79  96
93  .   84  45
93  .   95  52
94  .   7   26
94  .   13  51
94  .   14  48
94  .   15  7
94  .   21  37
94  .   26  95
94  .   75  53
94  .   83  1
94  .   90  97
94  .   99  69
94  .   100 48
95  .   2   23
95  .   7   43
95  .   20  11
95  .   27  56
95  .   62  33
95  .   63  57
95  .   67  45
95  .   74  16
95  .   80  41
95  .   82  51
95  .   88  7
95  .   90  56
96  .   2   68
96  .   4   19
96  .   5   29
96  .   14  16
96  .   22  65
96  .   26  81
96  .   31  77
96  .   35  60
96  .   37  93
96  .   50  62
96  .   52  60
96  .   66  16
96  .   68  58
96  .   74  43
96  .   89  17
96  .   95  50
96  .   100 49
97  .   18  36
97  .   26  10
97  .   38  64
97  .   43  75
97  .   44  49
97  .   60  71
97  .   67  66
97  .   96  71
98  .   4   20
98  .   5   15
98  .   34  39
98  .   36  23
98  .   39  50
98  .   68  38
98  .   72  75
98  .   86  28
99  .   20  23
99  .   27  50
99  .   39  19
99  .   43  57
99  .   66  49
99  .   67  50
99  .   72  41
99  .   77  56
99  .   78  20
99  .   86  14
99  .   93  43
100 .   3   28
100 .   9   37
100 .   61  38
100 .   64  39
100 .   77  41
100 .   79  41
100 .   83  49
100 .   88  8
100 .   91  37
100 .   99  27
/;

parameter cost(v,vv) 'cost between two nodes' /
1   .   37  5
1   .   59  59
1   .   72  1
2   .   15  1
2   .   20  39
2   .   26  6
2   .   37  36
2   .   58  8
2   .   60  9
2   .   76  9
2   .   80  21
2   .   90  1
2   .   95  26
2   .   100 10
3   .   15  0
3   .   37  6
3   .   40  1
3   .   41  9
3   .   56  24
3   .   59  20
3   .   73  11
3   .   76  4
4   .   7   9
4   .   29  24
4   .   46  17
4   .   61  6
4   .   80  3
4   .   83  15
4   .   98  5
5   .   11  19
5   .   34  1
5   .   55  5
5   .   79  7
5   .   80  11
5   .   85  77
5   .   87  14
5   .   92  13
5   .   99  14
6   .   8   1
6   .   15  16
6   .   24  45
6   .   30  10
6   .   31  20
6   .   35  17
6   .   39  7
6   .   40  1
6   .   41  17
6   .   51  12
6   .   74  14
6   .   82  10
7   .   6   15
7   .   8   37
7   .   10  1
7   .   24  5
7   .   25  2
7   .   35  53
7   .   47  11
7   .   52  103
7   .   74  10
8   .   6   29
8   .   16  4
8   .   18  12
8   .   21  14
8   .   25  13
8   .   26  2
8   .   39  9
8   .   46  19
8   .   55  12
8   .   58  8
8   .   63  39
8   .   83  13
9   .   5   15
9   .   18  3
9   .   22  1
9   .   48  3
9   .   60  13
9   .   79  15
9   .   92  3
10  .   13  20
10  .   15  11
10  .   31  8
10  .   37  7
10  .   85  19
10  .   88  8
10  .   93  15
10  .   96  3
11  .   1   9
11  .   2   8
11  .   13  27
11  .   15  9
11  .   22  21
11  .   24  1
11  .   34  13
11  .   48  32
11  .   53  87
11  .   54  31
11  .   55  10
11  .   61  5
11  .   62  32
11  .   82  18
11  .   89  6
11  .   92  7
12  .   16  7
12  .   27  13
12  .   32  2
12  .   65  10
12  .   77  10
13  .   11  17
13  .   50  16
13  .   59  1
13  .   74  12
13  .   100 23
14  .   18  13
14  .   32  10
14  .   39  4
14  .   47  33
14  .   63  7
14  .   79  3
14  .   85  37
14  .   100 2
15  .   14  21
15  .   25  7
15  .   27  13
15  .   37  12
15  .   44  28
15  .   48  3
15  .   60  22
15  .   63  13
16  .   4   11
16  .   41  14
16  .   53  17
16  .   60  2
16  .   81  40
16  .   84  2
16  .   90  21
16  .   97  54
17  .   7   5
17  .   12  2
17  .   28  5
17  .   35  8
17  .   37  6
17  .   42  11
17  .   46  6
17  .   47  21
17  .   64  8
17  .   66  22
17  .   81  11
17  .   88  4
17  .   91  14
17  .   93  61
17  .   100 14
18  .   30  50
18  .   31  16
18  .   49  1
18  .   53  14
18  .   59  17
18  .   64  27
18  .   66  14
18  .   67  23
19  .   6   1
19  .   12  4
19  .   30  18
19  .   39  1
19  .   40  10
19  .   42  1
19  .   47  39
19  .   53  11
19  .   72  2
19  .   81  12
20  .   8   14
20  .   16  7
20  .   29  22
20  .   38  17
20  .   42  25
20  .   47  10
20  .   66  13
20  .   83  13
20  .   95  4
21  .   16  4
21  .   28  55
21  .   31  12
21  .   40  13
21  .   44  57
21  .   57  12
21  .   79  4
22  .   9   15
22  .   10  18
22  .   11  14
22  .   12  4
22  .   16  28
22  .   33  21
22  .   47  6
22  .   64  12
22  .   66  8
22  .   77  7
22  .   82  18
22  .   91  7
22  .   94  4
23  .   4   13
23  .   20  12
23  .   58  8
23  .   64  39
23  .   66  72
23  .   67  20
23  .   68  20
23  .   86  17
23  .   89  12
23  .   98  7
24  .   1   7
24  .   12  12
24  .   27  4
24  .   29  8
24  .   57  5
24  .   69  16
24  .   86  10
25  .   34  23
25  .   44  38
25  .   61  3
25  .   81  4
25  .   86  29
26  .   39  60
26  .   41  11
26  .   43  9
26  .   44  8
26  .   57  14
26  .   78  67
26  .   80  1
26  .   94  8
27  .   9   22
27  .   19  318
27  .   21  16
27  .   36  20
27  .   45  12
27  .   53  8
27  .   60  1
27  .   89  21
28  .   5   3
28  .   44  20
28  .   48  11
28  .   52  18
28  .   64  35
28  .   68  8
28  .   81  11
28  .   82  11
28  .   96  56
28  .   98  15
29  .   20  102
29  .   68  23
29  .   81  21
29  .   83  13
29  .   87  47
29  .   99  3
29  .   100 38
30  .   4   40
30  .   29  12
30  .   33  31
30  .   55  10
30  .   90  1
30  .   99  4
31  .   3   10
31  .   6   65
31  .   11  9
31  .   19  6
31  .   25  11
31  .   42  2
31  .   64  4
31  .   71  7
31  .   89  7
31  .   94  9
32  .   2   2
32  .   6   21
32  .   15  19
32  .   19  8
32  .   27  12
32  .   41  36
32  .   56  14
32  .   72  3
32  .   84  13
32  .   85  1
32  .   92  9
33  .   5   4
33  .   8   16
33  .   20  30
33  .   39  29
33  .   46  7
33  .   61  9
33  .   69  13
33  .   76  15
33  .   84  2
33  .   86  17
34  .   24  1
34  .   26  12
34  .   38  26
34  .   41  10
34  .   42  1
34  .   57  16
34  .   58  30
34  .   59  26
34  .   81  13
34  .   89  9
34  .   90  7
34  .   92  10
34  .   96  32
34  .   100 17
35  .   33  18
35  .   34  14
35  .   43  88
35  .   48  3
35  .   49  29
35  .   52  29
35  .   62  11
35  .   65  7
35  .   88  10
36  .   6   13
36  .   33  13
36  .   40  14
36  .   45  9
36  .   53  16
36  .   56  10
36  .   62  17
36  .   69  15
36  .   76  8
36  .   99  15
36  .   100 11
37  .   12  12
37  .   19  5
37  .   24  210
37  .   41  9
37  .   56  3
37  .   69  2
37  .   76  10
38  .   6   32
38  .   20  31
38  .   26  2
38  .   32  73
38  .   35  3
38  .   51  15
38  .   81  3
38  .   82  5
38  .   86  4
38  .   90  10
38  .   95  23
39  .   12  9
39  .   20  11
39  .   43  1
39  .   50  11
39  .   77  18
39  .   88  28
39  .   99  43
40  .   11  30
40  .   12  5
40  .   27  14
40  .   47  5
40  .   55  9
40  .   68  40
40  .   74  20
40  .   78  13
40  .   82  1
40  .   88  13
40  .   100 14
41  .   2   20
41  .   7   13
41  .   23  7
41  .   27  6
41  .   45  32
41  .   49  38
41  .   58  18
41  .   73  8
41  .   77  16
41  .   79  1
41  .   83  10
41  .   87  5
41  .   97  8
41  .   99  4
42  .   7   10
42  .   14  1
42  .   30  8
42  .   31  44
42  .   51  15
42  .   61  18
42  .   68  17
42  .   70  20
42  .   93  8
42  .   94  9
42  .   100 14
43  .   6   18
43  .   8   5
43  .   31  8
43  .   33  6
43  .   45  2
43  .   61  28
43  .   69  9
43  .   75  20
43  .   77  3
43  .   85  5
44  .   7   14
44  .   56  8
44  .   58  18
44  .   67  11
44  .   76  14
44  .   79  12
44  .   84  16
44  .   94  11
44  .   98  2
45  .   6   15
45  .   7   38
45  .   14  7
45  .   43  29
45  .   44  26
45  .   46  15
45  .   53  13
45  .   65  10
45  .   92  13
45  .   99  1
46  .   4   20
46  .   18  1
46  .   25  17
46  .   44  22
46  .   51  28
46  .   72  1
46  .   80  10
46  .   82  17
47  .   5   4
47  .   13  15
47  .   15  17
47  .   20  13
47  .   39  1
47  .   55  1
47  .   72  7
47  .   75  1
47  .   84  2
47  .   87  2
48  .   2   6
48  .   7   4
48  .   11  30
48  .   25  9
48  .   55  7
48  .   60  8
48  .   66  15
48  .   73  8
48  .   86  2
48  .   100 21
49  .   7   14
49  .   20  3
49  .   26  9
49  .   31  67
49  .   57  16
49  .   66  17
50  .   7   21
50  .   9   14
50  .   10  5
50  .   14  12
50  .   34  11
50  .   42  104
50  .   66  18
50  .   78  2
50  .   81  3
50  .   87  1
50  .   95  27
51  .   7   2
51  .   14  46
51  .   38  1
51  .   39  2
51  .   47  4
51  .   50  2
51  .   68  9
51  .   85  25
51  .   86  13
51  .   89  37
51  .   98  2
52  .   2   15
52  .   3   55
52  .   26  2
52  .   36  10
52  .   37  1
52  .   41  29
52  .   53  8
52  .   65  11
52  .   76  2
52  .   96  17
52  .   99  3
53  .   2   19
53  .   4   17
53  .   16  41
53  .   19  1
53  .   23  14
53  .   35  15
53  .   37  6
53  .   39  62
53  .   49  4
53  .   56  6
53  .   74  25
53  .   75  8
53  .   80  3
53  .   92  8
53  .   94  2
53  .   97  107
53  .   100 16
54  .   18  3
54  .   22  32
54  .   24  12
54  .   34  6
54  .   39  62
54  .   40  18
54  .   75  5
54  .   84  6
54  .   93  4
54  .   97  51
54  .   98  2
54  .   100 2
55  .   7   13
55  .   12  11
55  .   25  10
55  .   28  11
55  .   41  20
55  .   44  16
55  .   57  4
55  .   70  22
55  .   78  7
55  .   83  1
55  .   89  4
56  .   14  3
56  .   23  18
56  .   26  4
56  .   28  11
56  .   35  6
56  .   46  22
56  .   58  11
56  .   84  5
56  .   88  10
57  .   5   18
57  .   21  49
57  .   25  38
57  .   26  1
57  .   35  15
57  .   42  11
57  .   46  11
57  .   48  15
57  .   50  10
57  .   58  13
57  .   72  15
57  .   75  18
58  .   2   5
58  .   5   3
58  .   10  11
58  .   19  15
58  .   21  1
58  .   64  21
58  .   75  4
58  .   77  1
58  .   96  16
59  .   2   12
59  .   8   2
59  .   24  7
59  .   36  19
59  .   44  4
59  .   49  11
59  .   63  4
59  .   78  6
59  .   89  21
60  .   2   28
60  .   6   46
60  .   30  9
60  .   39  11
60  .   40  6
60  .   82  8
60  .   89  5
60  .   94  11
61  .   11  5
61  .   39  10
61  .   48  10
61  .   63  22
61  .   71  12
61  .   72  2
61  .   82  5
61  .   95  8
61  .   100 22
62  .   9   4
62  .   10  4
62  .   19  14
62  .   20  4
62  .   23  11
62  .   27  4
62  .   39  8
62  .   60  12
62  .   77  12
62  .   79  13
62  .   85  20
62  .   98  13
62  .   100 15
63  .   5   3
63  .   12  14
63  .   34  12
63  .   38  8
63  .   40  8
63  .   44  11
63  .   47  9
63  .   52  53
63  .   54  6
63  .   62  11
63  .   68  10
63  .   96  3
64  .   4   31
64  .   8   11
64  .   17  18
64  .   30  9
64  .   36  33
64  .   51  22
64  .   68  6
65  .   11  2
65  .   15  13
65  .   22  4
65  .   30  30
65  .   47  26
65  .   57  25
65  .   70  5
66  .   6   7
66  .   19  2
66  .   20  11
66  .   21  26
66  .   37  9
66  .   38  16
66  .   41  20
66  .   49  6
66  .   52  1
66  .   60  9
66  .   76  14
66  .   92  22
67  .   6   9
67  .   41  9
67  .   52  5
67  .   68  11
67  .   86  13
68  .   8   13
68  .   17  29
68  .   35  4
68  .   39  59
68  .   41  4
68  .   55  4
68  .   66  18
68  .   70  19
68  .   72  24
68  .   92  10
69  .   8   8
69  .   51  1
69  .   72  2
70  .   5   12
70  .   9   13
70  .   13  9
70  .   18  5
70  .   20  4
70  .   22  2
70  .   24  61
70  .   25  11
70  .   27  5
70  .   28  5
70  .   35  5
70  .   42  34
70  .   56  15
70  .   78  8
70  .   93  5
71  .   2   9
71  .   9   6
71  .   20  41
71  .   74  29
71  .   77  3
71  .   85  21
71  .   89  4
71  .   99  43
72  .   5   4
72  .   8   5
72  .   17  9
72  .   27  8
72  .   35  16
72  .   37  33
72  .   44  1
72  .   53  9
72  .   55  6
72  .   83  11
72  .   86  9
73  .   28  12
73  .   85  19
73  .   97  20
73  .   99  26
74  .   7   17
74  .   8   12
74  .   11  27
74  .   34  1
74  .   38  22
74  .   51  1
74  .   55  14
74  .   79  6
75  .   8   13
75  .   16  3
75  .   23  4
75  .   33  2
75  .   40  7
75  .   45  25
75  .   70  18
75  .   71  4
75  .   72  11
75  .   96  7
76  .   4   8
76  .   21  20
76  .   25  16
76  .   30  32
76  .   39  5
76  .   41  5
76  .   43  9
76  .   61  4
76  .   68  13
76  .   74  16
76  .   84  20
76  .   97  13
77  .   30  8
77  .   63  10
77  .   70  31
77  .   76  4
77  .   78  11
77  .   79  1
77  .   88  12
77  .   91  5
78  .   11  67
78  .   36  3
78  .   48  10
78  .   49  15
78  .   65  6
78  .   68  48
78  .   84  11
78  .   88  24
78  .   95  8
79  .   1   3
79  .   22  6
79  .   41  27
79  .   46  14
79  .   51  7
79  .   54  4
79  .   57  6
79  .   68  15
79  .   71  17
79  .   88  22
80  .   1   43
80  .   25  5
80  .   37  13
80  .   40  10
80  .   41  27
80  .   44  26
80  .   47  8
80  .   61  26
80  .   93  10
80  .   97  7
80  .   100 9
81  .   7   3
81  .   29  12
81  .   43  2
81  .   65  12
81  .   85  2
81  .   94  2
82  .   20  12
82  .   68  4
82  .   70  9
82  .   73  2
82  .   74  14
82  .   92  7
82  .   93  149
82  .   100 15
83  .   3   5
83  .   4   9
83  .   11  3
83  .   18  19
83  .   19  16
83  .   32  12
83  .   45  4
83  .   48  5
83  .   50  19
83  .   63  17
83  .   65  15
83  .   78  8
83  .   91  20
83  .   99  7
84  .   4   10
84  .   10  176
84  .   12  11
84  .   17  10
84  .   31  11
84  .   52  4
84  .   86  47
84  .   90  51
84  .   99  20
85  .   2   6
85  .   3   2
85  .   5   3
85  .   13  11
85  .   14  54
85  .   61  16
85  .   69  2
85  .   73  7
85  .   76  15
85  .   87  6
85  .   92  13
85  .   94  13
85  .   95  5
85  .   98  68
86  .   6   6
86  .   7   11
86  .   19  4
86  .   23  2
86  .   38  12
86  .   68  47
86  .   74  8
86  .   79  5
86  .   90  39
86  .   91  20
86  .   92  14
87  .   20  130
87  .   25  12
88  .   22  10
88  .   27  5
88  .   30  21
88  .   39  11
88  .   49  21
88  .   63  11
88  .   70  34
88  .   75  14
88  .   76  16
88  .   79  25
88  .   83  9
88  .   95  139
88  .   96  9
88  .   97  19
88  .   100 115
89  .   12  4
89  .   16  4
89  .   35  8
89  .   52  10
89  .   57  9
89  .   68  14
89  .   70  8
89  .   91  33
90  .   5   8
90  .   8   5
90  .   12  3
90  .   14  2
90  .   15  3
90  .   30  4
90  .   45  1
90  .   46  3
90  .   65  16
90  .   72  1
90  .   75  2
90  .   94  2
91  .   3   13
91  .   4   73
91  .   14  15
91  .   36  103
91  .   47  28
91  .   55  12
91  .   77  12
91  .   83  3
91  .   88  19
91  .   96  34
92  .   4   13
92  .   6   6
92  .   9   13
92  .   32  33
92  .   42  61
92  .   93  9
92  .   97  11
93  .   2   6
93  .   29  13
93  .   38  2
93  .   43  11
93  .   48  9
93  .   59  11
93  .   73  23
93  .   79  9
93  .   84  1
93  .   95  11
94  .   7   2
94  .   13  18
94  .   14  3
94  .   15  29
94  .   21  27
94  .   26  2
94  .   75  11
94  .   83  449
94  .   90  11
94  .   99  4
94  .   100 20
95  .   2   25
95  .   7   15
95  .   20  87
95  .   27  10
95  .   62  28
95  .   63  2
95  .   67  1
95  .   74  17
95  .   80  16
95  .   82  4
95  .   88  72
95  .   90  12
96  .   2   14
96  .   4   25
96  .   5   23
96  .   14  42
96  .   22  5
96  .   26  2
96  .   31  8
96  .   35  5
96  .   37  9
96  .   50  10
96  .   52  6
96  .   66  38
96  .   68  13
96  .   74  7
96  .   89  13
96  .   95  5
96  .   100 14
97  .   18  28
97  .   26  57
97  .   38  6
97  .   43  1
97  .   44  13
97  .   60  1
97  .   67  2
97  .   96  5
98  .   4   27
98  .   5   53
98  .   34  22
98  .   36  35
98  .   39  15
98  .   68  3
98  .   72  12
98  .   86  34
99  .   20  13
99  .   27  3
99  .   39  41
99  .   43  3
99  .   66  21
99  .   67  6
99  .   72  11
99  .   77  17
99  .   78  27
99  .   86  51
99  .   93  3
100 .   3   32
100 .   9   18
100 .   61  22
100 .   64  2
100 .   77  9
100 .   79  2
100 .   83  1
100 .   88  57
100 .   91  10
100 .   99  32
/;

scalar budget / 73 /;

Binary Variable x(v,vv) 'network flow from v to vv';
variable total_cost 'cost of the flow';
variable total_dist 'total distance of the flow';
Variable total_cities_visited 'count number of cities visited (incl. first and last)';

Equation eq_dist 'determine total distance by flow';
eq_dist..
        total_dist =E= sum((v,vv)$(dist(v,vv)>0), dist(v,vv)*x(v,vv));

Equation eq_cost 'determine total cost by flow';
eq_cost..
        total_cost =E= sum((v,vv)$(cost(v,vv)>0), cost(v,vv)*x(v,vv));

Equation eq_visited 'determine number of cities visited (incl. first and last)';
eq_visited..
        total_cities_visited =E= sum((v,vv)$(cost(v,vv)>0), x(v,vv)) +1;
        
equation eq_flow_conservation(v) 'Establish flow conservation in each node';
eq_flow_conservation(v).. sum(vv$(dist(v,vv)>0), x(v,vv)) - sum(vv$(dist(vv,v)>0), x(vv,v)) =e= b(v);

model network_flow_with_budget / all /;
network_flow_with_budget.optfile = 1;
option ResLim=1000;

* solve first with unlimited budget for shortest distance
solve network_flow_with_budget minimizing total_dist using mip;
* solve with limited budget for shortest distance
total_cost.up = budget;
solve network_flow_with_budget minimizing total_dist using mip;
* solve for most cities visited with limited budget 
solve network_flow_with_budget maximizing total_cities_visited using mip;
